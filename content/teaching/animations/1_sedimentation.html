<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Particle Sedimentation Simulation</title>
    <style>
        body, html {
            margin: 0;
            padding: 0;
            width: 100%;
            height: 100%;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: flex-start;
        }
        /* Container for the canvas */
        #canvas-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: flex-start;
            width: 100%;
            height: 100%;
            position: relative;
        }
        canvas {
            border: 1px solid black;
            width: 50%;
            height: 50%;
                  
        }
        /* Position controls below the canvas */
        #controls {
            position: absolute;
            bottom: 10px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(255, 255, 255, 0.8);
            padding: 10px;
            border-radius: 5px;
            width: 90%; /* Adjust as needed */
            display: flex;
            flex-direction: column; /* Arrange sliders vertically */
            align-items: center;
        }
        #controls label, #controls input {
            width: 100%;
            margin-bottom: 10px;
        }
    </style>
</head>
<body>
    <canvas id="canvas"></canvas>
    <div id="controls">
        <label for="temperature">Temperature: </label>
        <input type="range" id="temperature" min="0" max="20" step="0.1" value="1">
        <label for="radius">Radius: </label>
        <input type="range" id="radius" min="0" max="5" step="0.1" value="1">
    </div>

    <script>
      const canvas = document.getElementById("canvas");
      const ctx = canvas.getContext("2d");
      const temperatureSlider = document.getElementById("temperature");
      const radiusSlider = document.getElementById("radius");
      const particles = [];
      const numParticles = 100;
      let noiseStrength = parseFloat(temperatureSlider.value);
      let radius = parseFloat(radiusSlider.value);
      const rho_particle = 1.0; // Density of the particle
      const rho_liquid = 0.5; // Density of the liquid
      const g = 9.81; // Gravitational acceleration
      const diffusionScale = 10; // Scale factor to slow down diffusion
      const gscale = 0.01;//scale gravitational force
      const updateDelay = 50; // Delay in milliseconds

      class Particle {
        constructor(x, y) {
          this.x = x;
          this.y = y;
        }

        update() {
          // Apply noise
          this.x += (Math.random() - 0.5) * noiseStrength * diffusionScale;
          this.y += (Math.random() - 0.5) * noiseStrength * diffusionScale;

          // Apply gravitational force
          const gravitationalForce =
            (4 / 3) *
            Math.PI *
            Math.pow(radius, 3) *
            (rho_particle - rho_liquid) *
            g;
          this.y += gravitationalForce *gscale;

          // Boundary conditions
          if (this.x < 0) this.x = 0;
          if (this.x > canvas.width) this.x = canvas.width;
          if (this.y < 0) this.y = 0;
          if (this.y > canvas.height) this.y = canvas.height;
        }

        draw() {
          ctx.beginPath();
          ctx.arc(this.x, this.y, radius, 0, Math.PI * 2);
          ctx.fillStyle = "blue";
          ctx.fill();
          ctx.strokeStyle = 'black'; // Set the stroke color to black
          ctx.lineWidth = 1; // Set the stroke width
          ctx.stroke(); // Apply the stroke
          ctx.closePath();
        }
      }

      function init() {
        for (let i = 0; i < numParticles; i++) {
          particles.push(
            new Particle(
              Math.random() * canvas.width,
              Math.random() * canvas.height
            )
          );
        }
      }

      function animate() {
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        particles.forEach((particle) => {
          particle.update();
          particle.draw();
        });
        setTimeout(() => {
                requestAnimationFrame(animate);
            }, updateDelay);
      }

      temperatureSlider.addEventListener("input", () => {
        noiseStrength = parseFloat(temperatureSlider.value);
      });

      radiusSlider.addEventListener("input", () => {
        radius = parseFloat(radiusSlider.value);
      });

      init();
      animate();
    </script>
  </body>
</html>
